def gd (--)
    $DOTFILES cd
end

def q (--)
    0 exit
end

def lf_last_dir_file (-- str)
    # This makes it work on Linux and Windows for now.
    $HOME? ($"{$HOME}/.config/lf/lf_lastdir") ($"{$LOCALAPPDATA}/mshell/lf_lastdir") iff
end

def lf (--)
    ['lf' '-last-dir-path' lf_last_dir_file]?
    (lf_last_dir_file readFile cd) iff
end

def yazi (--)
    tempFile t!
    ['yazi' $"--cwd-file={@t}"]?
    (@t readFile cd) iff
end

def f (--) lf end

def r (--)
    ['lf' '-last-dir-path' lf_last_dir_file $REPOS]?
    (lf_last_dir_file readFile cd) iff
end

def j (--)
    $JOBSDIR?
    (
        ['lf' '-last-dir-path' lf_last_dir_file $JOBSDIR]?
        (lf_last_dir_file readFile cd) iff
    )
    ('Jobs dir ($JOBSDIR) not set.' wle)
    iff
end

def wt_cwd (--)
    $"\e]9;9;{pwd}\e\\" w
end

def buildings (-- [str])
    [ "XI2004" "Q12480" "82361" "ORK037" "L23120" "SB025" "33222" "J2301" "G3108" "CO0609" ]
end

def of (--)
    [open_facility_grid];
end

def g (--)
  pwd [fzf-tmsu]? (drop) (cd) iff
end

def gm (--)
     $OneDriveCommercial toPath `meetingnotes` /
     path!
     @path isDir
     (@path cd)
     ($"{@path} is not a directory." wle)
     iff
end

def zip2list (a b --)
    (val2! val1! [@val1 @val2]) zip
end

def minPerDay (-- float) 1440 end

hostname "prec3660-mp" = runtime "windows" = and ($"{$USERPROFILE}\\.local\\bin;C:\\Program Files\\gnuplot\\bin;C:\\Program Files\\Java\\jdk-25\\bin;{$PATH};C:\\Program Files\\MySQL\\MySQL Workbench 8.0 CE;C:\\Program Files\\7-zip;{$LOCALAPPDATA}\\Microsoft\\WinGet\\Packages\\hpjansson.Chafa_Microsoft.Winget.Source_8wekyb3d8bbwe\\chafa-1.16.2-1-x86_64-win\\" $PATH!) iff

def mshCompletion ([str] -- [str])
    input!
    ['-h' '--help' '--html' '--lex' '--parse' '--version' '-c'] options!
    ['lsp' 'bin' 'completions'] subcommands!

    @input len 0 >
    (
        @input :0: first!
        @first 'lsp' =
        ([]) # Nothing after lsp
        (
            @input :0: 'bin' =
            (
                ['add' 'remove' 'list' 'path' 'edit' 'audit' 'debug']
            )
            (
                @input :0: 'completions' =
                (
                    ['fish' 'bash' 'nushell' 'elvish']
                )
                (
                    []
                ) iff
            )
            iff
        )
        iff
    )
    (
        @options @subcommands extend
    )
    iff
end
