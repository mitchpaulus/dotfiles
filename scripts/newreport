#!/usr/bin/env mshell
"Usage: newreport <report name>" usage!

args len 1 != (@usage wle 1 exit) iff

args (a! @a "-h" = @a "--help" = or) any (@usage wle 0 exit) iff

args :0: reportName!
@reportName ".docx" endsWith not ($"{@reportName}.docx" reportName!) iff
@reportName isFile ($"Report {@reportName} already exists" wle 1 exit) iff

`/mnt/c/Users/mpaulus/Command Commissioning/Library - Resources/Templates/ccllc-technical-report-template.docx` isFile
(`/mnt/c/Users/mpaulus/Command Commissioning/Library - Resources/Templates/ccllc-technical-report-template.docx` @reportName cp 0 exit) iff

`/mnt/c/Users/mpaulus/Command Commissioning/Library - Documents/Resources/Templates/ccllc-technical-report-template.docx` isFile
(`/mnt/c/Users/mpaulus/Command Commissioning/Library - Documents/Resources/Templates/ccllc-technical-report-template.docx` @reportName cp 0 exit) iff

$JOBSDIR? if
    $JOBSDIR toPath `Library - Documents` / `Resources` / `Templates` / `ccllc-technical-report-template.docx` / f!
    @f isFile if @f @reportName cp 0 exit end
end

"Could not find report template" wle 1 exit
